
@{
    ViewBag.Title = "Book Appointment";
}
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<!--Date Dropper-->
<link href="~/Content/Plugins/Datedropper3/datedropper.css" rel="stylesheet" />
<script src="~/Content/Plugins/Datedropper3/datedropper.js"></script>
<link href="~/Content/StyleSheets/DateDropperCivica.css" rel="stylesheet" />

<!--JQuerryTimePicker-->
<script src="~/Content/Plugins/jquery-timepicker-1.3.5/jquery.timepicker.min.js"></script>
<link href="~/Content/Plugins/jquery-timepicker-1.3.5/jquery.timepicker.min.css" rel="stylesheet" />

<script>

    function checkAvailability() {

        var isEveryDay = false;
        var isEveryDayWorking = false;
        var isEveryDay = false;
        var everySpecifiedWorkingDate = -1;

        var isSunday = false;
        var isMonday = false;
        var isTuesday = false;
        var isWednesday = false;
        var isThursday = false;
        var isFriday = false;
        var isSaturday = false;

        var dayVise = false;
        var dayTypeVise = false;

        var Nthday = -1;
        var DayMonth = -1;

        var NthMonthDay = "";
        var DayTypeMonth = "";
        var MonthNumber = -1;

        

        switch ($('input[name=ActiveSelectionTab]:checked').val()) {

            //Daily
            case '1': switch ($('input[name=DailySelectionType]:checked').val()) {
                        case '1':
                            {
                                isEveryDay = true;
                            }
                            break;
                        case '2':
                            {
                                isEveryDayWorking = true;
                            }
                            break;
                        case '3':
                            {
                                everySpecifiedWorkingDate = $('#DailyRepeatFrequency').val();
                            }
                            break;

                    }
                break;

            //Weekly
            case '2':
                switch ($('input[name=WeeklySelectionType]:checked').val()) {
                    case '1':
                        {
                            var isSunday = true;
                        }
                        break;
                    case '2':
                        {
                            var isMonday = true;
                        }
                        break;
                    case '3':
                        {
                            var isTuesday = true;
                        }
                        break;
                    case '4':
                        {
                            var isWednesday = true;
                        }
                        break;
                    case '5':
                        {
                            var isThursday = true;
                        }
                        break;
                    case '6':
                        {
                            var isFriday = true;
                        }
                    case '7':
                        {
                            var isSaturday = true;

                        }
                        break;
                }
                break;

            //Monthly
            case '3': switch ($('input[name=MonthlySelectionType]:checked').val())
                {
                case '1':
                    {
                        var dayVise = true;
                        Nthday = $('#DayWiseSelection-Days').val();
                        DayMonth = $('#DayWiseSelection-Months').val();
                    }
                    break;

                case '2':
                    {
                        dayTypeVise = true;
                        NthMonthDay = $('#MonthWiseSelection-daytype').val();
                        NthMonthDay = $('#MonthWiseSelection-day').val();
                        MonthNumber = $('#MonthWiseSelection-Month').val();
                    }
                    break;

            }
                break;

                //Custom
            case '4':
                break;

        }

        var data = {
            Capacity: $('#NumberOfAttendees').val(),
            FloorID: $('#FloorSelection').val(),
            StartDate: $('#StartDate').val(),
            EndtDate: $('#EndDate').val(),
            StartTime: $('#StartTime').val(),
            Duration: $('#Duration').val(),
            RecurrenceType: $('#ActiveSelectionTab').val(),
            IsEveryDay: isEveryDay,
            IsEveryDayWorking: isEveryDayWorking,
            EverySpecifiedWorkingDate: everySpecifiedWorkingDate
        };
        var jqxhr = $.post("FetchAvailability", data, function () { }, 'json')
    .done(function (response) {
        if (response instanceof Object)
            var json = response;
        else
            var json = $.parseJSON(response);

        $("#Cal").empty();

        var tr;
        tr = $('<tr/>');
        tr.append("<th>Room Name</th>");
        tr.append("<th>Available</th>");
        tr.append("<th>Star tDate</th>");
        tr.append("<th>Start Time</th>");
        tr.append("<th>End Date</th>");
        tr.append("<th>End Time</th>");
        $('#Cal').append(tr);
        //Append each row to html table
        for (var i = 0; i < json.length; i++) {
            tr = $('<tr/>');
            tr.append("<td>" + json[i].RoomName + "</td>");
            tr.append("<td>" + json[i].IsAvailable + "</td>");
            tr.append("<td>" + json[i].BookingSlot.StartDate + "</td>");
            tr.append("<td>" + json[i].BookingSlot.StartTime + "</td>");
            tr.append("<td>" + json[i].BookingSlot.EndDate + "</td>");
            tr.append("<td>" + json[i].BookingSlot.EndTime + "</td>");
            $('#Cal').append(tr);
        }
        if (json.length > 1) {
            $('#CalendarTable').css('display', 'block');
        }
    });
    };

</script>

@using (Html.BeginForm("MultipleCommand", "Home", FormMethod.Post, new { id = "submitForm" }))
{
    <div class="mainDivision">
        <table>
            <!--Meeting Title Iuput-->
            <tr>

                <td>
                    Appointment Title :
                </td>

                <td colspan="5">
                    <input id="AppointmentTitle" name="AppointmentTitle" class="FullSpread" type="text" />
                </td>
            </tr>

            <tr>
                <!--Floor Selection Drop Dopwn-->
                <td>
                    Select Floor :
                </td>

                <td>
                    @Html.DropDownList("FloorSelection", ViewData["Floors"] as List<SelectListItem>, new { @class = "FullSpread" })
                </td>

                <!--Number of Attendees -->
                <td>
                    No. of Attendees :
                </td>

                <td>
                    <input class="GeneralNumberInput" id="NumberOfAttendees" name="NumberOfAttendees" type="number" min="2" value="2">
                </td>
            </tr>

            <tr>
                <!--Start Date input-->
                <td>
                    Start Date :
                </td>

                <td>
                    <input id="StartDate" name="StartDate" class="DateInput" type="text" data-format="d/M/Y" data-large-mode="true" data-large-default="true" data-lock="from" data-theme="DateDropperCivica" data-min-year="2018" data-max-year="2028" />
                    <script>
                        $('#StartDate').dateDropper();
                    </script>
                </td>
                <!--End Date input-->
                <td>
                    End Date :
                </td>

                <td>
                    <input id="EndDate" name="EndDate" class="DateInput" type="text" data-format="d/M/Y" data-large-mode="true" data-large-default="true" data-lock="from" data-theme="DateDropperCivica" data-min-year="2018" data-max-year="2028" />

                    <script>
                        $('#EndDate').dateDropper();
                    </script>
                </td>
            </tr>
            <tr>
                <!--Start Time Input-->
                <td>
                    Start Time :
                </td>
                <td>
                    <input id="StartTime" name="StartTime" class="TimeInput" type="text" />
                    <script>
                        $('.TimeInput').timepicker({
                            timeFormat: 'hh:mm p',
                            interval: 15,
                            minTime: '10',
                            maxTime: '10:00pm',
                            defaultTime: 'now',
                            startTime: '10:00',
                            dynamic: false,
                            dropdown: true,
                            scrollbar: true
                        });
                    </script>
                </td>

                <!--Time Duration-->
                <td>
                    Duration :
                </td>

                <td>
                    <input id="Duration" name="Duration" class="TimeInput2" type="text" />

                    <script>
                        $('.TimeInput2').timepicker(
                            {
                                timeFormat: 'HH:mm',
                                interval: 15,
                                minTime: '0',
                                maxTime: '23:00pm',
                                defaultTime: '0:15',
                                dynamic: false,
                                dropdown: true,
                                scrollbar: true
                            });
                    </script>

                </td>
            </tr>

            <tr>
                <!--End Time-->
                <td>
                    End Time :
                </td>

                <td>
                    <input id="EndTime" name="EndTime" class="TimeInput" type="text" disabled />
                </td>
            </tr>

            <tr>
                <!--Regression Type Selection Tabs-->
                <td id="RegressionTypeSelectionTableData" colspan="6">

                    <input type="hidden" id="ActiveSelectionTab" name="ActiveSelectionTab" value="1">
                    <script>
                        function SelectDaily()
                        {
                            document.getElementById("ActiveSelectionTab").value = 1;

                        }
                        function SelectWeekly() {
                            document.getElementById("ActiveSelectionTab").value = 2;
                        }
                        function SelectMonthly() {
                            document.getElementById("ActiveSelectionTab").value = 3;
                        }
                        function SelectCustom() {
                            document.getElementById("ActiveSelectionTab").value = 4;
                        }
                    </script>
                    <!--Selection Tabs-->
                    <div class="tab">
                        <input type="button" class="tablinks" onclick="SelectDaily();openTab(event, 'Daily')" id="defaultOpen" value="Daily" /><br />
                        <input type="button" class="tablinks" onclick="SelectWeekly(); openTab(event, 'Weekly')" value="Weekly"><br />
                        <input type="button" class="tablinks" onclick="SelectMonthly();openTab(event, 'Monthly')" value="Monthly"><br />
                        <input type="button" class="tablinks" onclick="SelectCustom();openTab(event, 'Custom')" value="Custom"><br />
                    </div>

                    <!--Daily Selection-->
                    <div id="Daily" class="tabcontent">
                        <script>
                            function EveryDayRadioCheck() {
                                document.getElementById("DailyRepeatFrequency").disabled = "true";
                            }
                            function EveryNDayRadioCheck() {

                                document.getElementById("DailyRepeatFrequency").disabled = ! "true";
                            }
                            function EveryWorkingDayRadioCheck() {
                                document.getElementById("DailyRepeatFrequency").disabled = ! "true";
                            }

                        </script>
                        <input id="EveryDay" name="DailySelectionType" type="radio" onclick="javascript:EveryDayRadioCheck()" checked="checked" value="1"> Every Day
                        <br /><br />
                        <input id="EveryWorkingDay" name="DailySelectionType" type="radio" onclick="javascript:EveryDayRadioCheck()" value="2"> Every Working Day
                        <br /><br />
                        <input id="EveryNDay" name="DailySelectionType" type="radio" onclick="javascript:EveryWorkingDayRadioCheck()" value="3">

                        Every <input class="GeneralNumberInput" id="DailyRepeatFrequency" type="number" min="1" value="1" /> Day(s).

                    </div>

                    <!--Weekly Selection-->
                    <div id="Weekly" class="tabcontent">
                        <div style="float:left;">
                            <input id="Monday" name="WeeklySelectionType" type="checkbox" value="2"> Monday<br />
                            <input id="Tuesday" name="WeeklySelectionType" type="checkbox" value="3"> Tuesday<br />
                            <input id="Wednesday" name="WeeklySelectionType" type="checkbox" value="4"> Wednesday<br />
                            <input id="Thursday" name="WeeklySelectionType" type="checkbox" value="5"> Thursday<br />
                            <input id="Friday" name="WeeklySelectionType" type="checkbox" value="6"> Friday<br />
                        </div>

                        <div style="float:right">
                            <input id="Saturday" name="WeeklySelectionType" type="checkbox" value="7"> Saturday<br />
                            <input id="Sunday"  name="WeeklySelectionType" type="checkbox" value="1"> Sunday<br />

                        </div>
                    </div>

                    <!--Monthly Selection-->
                    <div id="Monthly" class="tabcontent">
                        <script>
                            function DayWiseRadioCheck() {

                                document.getElementById("MonthWiseSelection-daytype").disabled = "true";
                                document.getElementById("MonthWiseSelection-day").disabled = "true";
                                document.getElementById("MonthWiseSelection-Month").disabled = "true";

                                document.getElementById("DayWiseSelection-Days").disabled = ! "true";
                                document.getElementById("DayWiseSelection-Month").disabled = ! "true";
                            }
                            function MonthWiseRadioCheck() {
                                document.getElementById("DayWiseSelection-Days").disabled = "true";
                                document.getElementById("DayWiseSelection-Month").disabled = "true";
                                document.getElementById("MonthWiseSelection-daytype").disabled = ! "true";
                                document.getElementById("MonthWiseSelection-day").disabled = ! "true";
                                document.getElementById("MonthWiseSelection-Month").disabled = ! "true";
                            }
                        </script>
                        <input id="DayWise" type="radio" name="MonthlySelectionType" onclick="javascript:DayWiseRadioCheck()" /> Day
                        <input class="GeneralNumberInput" id="DayWiseSelection-Days" type="number" value="30" min="1" max="31" /> of every
                        <input class="GeneralNumberInput" id="DayWiseSelection-Month" type="number" value="1" min="1" /> Month.
                        <br />
                        <br />
                        <input id="MonthWiseSelection" type="radio" name="MonthlySelectionType" onclick="javascript:MonthWiseRadioCheck()" />
                        <select id="MonthWiseSelection-daytype">
                            <option>First</option>
                            <option>Second</option>
                            <option>Third</option>
                            <option>Fourth</option>
                            <option>Last</option>

                        </select>

                        <select id="MonthWiseSelection-day">
                            <option>Day</option>
                            <option>WeekDay</option>
                            <option>Weekend</option>

                            <option>Sunday</option>
                            <option>Monday</option>
                            <option>Tuesday</option>
                            <option>Wednesday</option>
                            <option>Thursday</option>
                            <option>Friday</option>
                            <option>Saturday</option>

                        </select>
                        of every
                        <input class="GeneralNumberInput" id="MonthWiseSelection-Month" type="number" value="1" min="1" /> Month.


                    </div>

                    <!--Custom Selection-->
                    <div id="Custom" class="tabcontent">



                    </div>

                </td>
            </tr>
            <tr>
                <td colspan="6">
                    <input style="float:right;width:140px;" id="Fetch" type="button" value="Check Availability" class="MainButton" onclick="checkAvailability()" />
                </td>
            </tr>
            <tr id="CalendarTable" style="display:none">
                <td>
                    <table class="table table-striped table-bordered table-hover table-condensed" id="Cal"></table>
                </td>
            </tr>
            <tr>

                <td colspan="6">
                    <input style="float:left;" id="Cancel" type="button" value="Cancel" class="MainButton" name="Command" />
                    <input style="float:right;" id="Submit" type="submit" value="Submit" class="MainButton" name="Command" />
                </td>
            </tr>


        </table>


    </div>
}

<!--Duration Picker-->
<script>
    window.onload = function () {
        document.getElementById("defaultOpen").click();
    };
</script>



